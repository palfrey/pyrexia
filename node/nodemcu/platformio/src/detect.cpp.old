return;
  wl_status_t status = WiFi.status();
  switch (status) {
	  case WL_CONNECTED: // all good
		  break;
	  case WL_SCAN_COMPLETED:
	  case WL_IDLE_STATUS:
	  {
		  unsigned long currentMillis = millis();
		  if (currentMillis - wifi_start_time >= 30*1000) {
			  Serial.printf("Been trying to connect for %ld seconds, restarting\n", (currentMillis - wifi_start_time)/1000);
			  retryWifi();
		  }
		  else {
			  Serial.printf("Connecting to WiFi (%d)\n", status);
			  blink(500);
		  }
		  return;
	  }

	  case WL_NO_SSID_AVAIL:
		  Serial.printf("Problem connecting to WiFi: can't find SSID \"" WIFI_SSID "\"\n");
		  retryWifi();
		  return;

	  case WL_DISCONNECTED:
	  case WL_CONNECT_FAILED:
	  case WL_CONNECTION_LOST:
		  Serial.printf("Problem connecting to WiFi \"" WIFI_SSID "\": %d\n", status);
		  retryWifi();
		  return;

	  case WL_NO_SHIELD:
		  Serial.println("Can't find WiFi Shield!\n");
		  blink(2000);
		  return;
  }
